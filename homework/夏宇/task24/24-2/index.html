<!DOCTYPE html>
<!--
Created using JS Bin
http://js.jirengu.com

Copyright (c) 2016 by anonymous (http://js.jirengu.com/wivogihuqi/1/edit)

Released under the MIT license: http://jsbin.mit-license.org
-->
<meta name="robots" content="noindex">
<html>
<head>
  <meta charset="utf-8">
  <title>JS Bin</title>
<style id="jsbin-css">
*{margin:0;padding:0}
ul{list-style:none;}
li{
  border:1px solid #ddd;
  margin:2px 0;
}
li:hover{
  background:green;
  cursor: pointer;
}
div{
  text-align:center;
}
</style>
</head>
<body>
<ul id='ct'>
  <li>内容1</li>
  <li>内容2</li>
</ul>
  <div><button id='btn'>加载更多</button></div>
<script id="jsbin-javascript">

var oUl=document.getElementById('ct')
var oBtn=document.getElementById('btn')
var start=3;
var len=6;
oBtn.onclick=function(){
  ajax({
        url: "task24-2.php",
        type: "get",
        data: {
          "start": start,
          "len": len
        },
        success:function(ret){
        var text = "";
        for(var i=0; i<len; i++){
           var num = start + i;
           text = '内容' + num;
           var newli = document.createElement("li");
           newli.innerText = text;
           ct.appendChild(newli);
         }
        start = ret;
        },
        error:function(){
          console.log("出错啦");
        }
  })
}
function ajax(opts){
  var xhr=new XMLHttpRequest();
xhr.onreadystatechange=function(){
  if(xhr.readyState===4&&xhr.status===200){
      var json=JSON.parse(xhr.responseText)
      opts.success(json);
  }
  if(xhr.status!=200){
    opts.error();
  }
}
  var dataString='';
  for( var key in opts.data){
    dataString+=key+'='+opts.data[key]+'&'
  }
  dataString=dataString.substr(0,dataString.length-1)
  if(opts.type.toLowCase()==='get'){
    xhr.open('get',opts.url+'?'+dataString,false);
    xhr.send();
  }
  if(opts.type.toLowCase()==='post'){
    xhr.open('post',opts.url,false);
    xhr.setRequestHeader('content-type','application/x-www-form-urlencoded');
    xhr.send(dataString);
  }
}

</script>
</body>
</html>
